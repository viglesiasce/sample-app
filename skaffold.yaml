apiVersion: skaffold/v2beta13
kind: Config
metadata:
  name: backend
build:
  artifacts:
  - image: sample-app
test:
  - image: sample-app
    custom:
    # Specify absolute path of your K8s folder to mount to validation image
    - command:  |
         docker run -v `pwd`/k8s:/k8s \
                    -v /var/run/docker.sock:/var/run/docker.sock \
                    gcr.io/vicnastea/validate-policies:latest
deploy:
  kubectl:
    manifests: ["k8s/dev.yaml"]
portForward:
  - resourceName: sample-app-dev
    resourceType: service
    namespace: default
    port: 8080